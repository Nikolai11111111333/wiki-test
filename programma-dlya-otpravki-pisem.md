# Программа для отправки писем

## Описание программы отправки электронной почты с помощью Python

### Введение

Эта программа написана на Python и предназначена для отправки электронной почты с использованием SMTP-сервера. Она использует модули `smtplib`, `getpass`, `email.mime.text`, `csv` и `sys` для чтения учетных данных, создания сообщений, чтения данных из CSV-файла и записи вывода в файл.

### Функциональность

#### Программа выполняет следующие основные функции:

1. Сначала программа считывает учетные данные из файла "my\_email.txt". Этот файл содержит адрес электронной почты в первой строке и пароль от этого электронного адреса во второй строке.
2. После этого программа открывает файл "таблица.csv" и читает данные из него. Каждая строка в этом файле предполагается содержать адрес получателя и текст сообщения, разделенные точкой с запятой.
3. Затем программа создает MIME-объект сообщения, указывая текст сообщения, отправителя, получателя и тему.
4. Далее программа устанавливает соединение с SMTP-сервером (в этом случае, используется SMTP-сервер Яндекса) через защищенное SSL-соединение, выполняет вход с использованием учетных данных из файла и отправляет сообщение каждому адресату из файла "таблица.csv".
5. По мере отправки каждого сообщения программа также выводит информацию о отправителе, получателе, а также содержимом сообщения в файл "output.txt". После отправки всех сообщений, программа закрывает соединение с SMTP-сервером.

### Использование

Чтобы использовать эту программу на разных операционных системах, необходимо выполнить следующие шаги:

1. [Установить Python](programma-dlya-otpravki-pisem.md#ustanovka-python) и [необходимые библиотеки](programma-dlya-otpravki-pisem.md#ustanovka-neobkhodimykh-bibliotek).
2. Создать файл `my_email.txt` и записать в него адрес электронной почты и пароль.
3. Создать файл `таблица.csv` и заполнить его данными, содержащими адреса электронных почт и текст сообщений.
4. Запустить программу с помощью команды `python3 имя_файла.py` на Linux и macOS или `python имя_файла.py` на Windows.

Для установки Python и необходимых библиотек на разных операционных системах, выполните следующие шаги:

### Установка Python

#### На Linux

* **Ubuntu и Debian**: выполните следующие команды в терминале:

```
sudo apt update
sudo apt install python3
```

* **Fedora**: выполните следующие команды в терминале:

```
sudo dnf update
sudo dnf install python3
```

* **Arch Linux и Manjaro**: выполните следующие команды в терминале:

```
sudo pacman -Syu
sudo pacman -S python
```

#### На macOS

1. Перейдите на официальный сайт Python по [адресу](https://www.python.org/downloads/mac-osx/).
2. Выберите нужную версию Python и скачайте установочный файл.
3. Запустите установочный файл и следуйте инструкциям мастера установки.
4. После завершения установки откройте терминал и введите `python3 --version`. Вы увидите версию установленного Python.

#### На Windows

1. Перейдите на официальный сайт Python по [адресу](https://www.python.org/downloads/windows/).
2. Выберите нужную версию Python и скачайте установочный файл.
3. Запустите установочный файл и следуйте инструкциям мастера установки.
4. После завершения установки откройте командную строку (cmd) и введите `python --version` или `python3 --version`. Если все сделано правильно, вы увидите версию установленного Python.

### Установка необходимых библиотек

#### Для работы этой программы необходимы следующие библиотеки Python:

1. `smtplib`: модуль для работы с серверами SMTP.
2. `getpass`: модуль для считывания пароля без экранирования.
3. `email.mime.text`: модуль для создания сообщений с текстовым контентом.
4. `csv`: модуль для считывания данных из файла CSV.
5. `sys`: модуль для управления стандартными потоками вывода и ошибок.

#### Для установки этих библиотек на разных операционных системах, используйте следующие команды:

* На Linux и macOS:

```
pip3 install smtplib getpass email csv
```

* На Windows:

```
pip install smtplib getpass email csv
```

После установки Python и необходимых библиотек, вы сможете запустить программу, описанную в предыдущем ответе, на разных операционных системах.





Программа будет отправлять электронные письма на адреса, указанные в файле `таблица.csv`, с использованием адреса электронной почты и пароля, указанных в файле `my_email.txt`. Результаты отправки будут записываться в файл `output.txt`.



Для использования этой программы вам потребуется CSV-файл `таблица.csv`, содержащий два столбца: адрес электронной почты получателя и текст сообщения. Каждая строка в файле представляет отдельное сообщение.

Пример содержимого CSV-файла:

```kotlin
john@example.com;Hello John, this is a test message.
jane@example.com;Hello Jane, this is a test message.
```

После запуска программы она прочитает этот файл, создаст два сообщения и отправит их на соответствующие адреса электронной почты.

### Заключение

Эта программа представляет собой простой и эффективный инструмент для автоматизации отправки электронной почты из Python. Она может быть полезна в различных сценариях, таких как отправка уведомлений, рассылки или любых других задач, которые требуют автоматической отправки электронной почты.
